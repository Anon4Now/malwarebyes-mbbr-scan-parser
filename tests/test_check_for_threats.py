"""Module containing tests for check_for_threats.py"""
import xml.etree.ElementTree

# Third-party imports
import pytest

# Local App imports
from resources.check_for_threats import Threats
from resources.utils import read_file


@pytest.fixture
def get_single_threats_from_threat() -> xml.etree.ElementTree.Element:
    """Get the XML element tree for single threat events in test_resources"""
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_all_single_events.XML')
    return xml_element


@pytest.fixture
def get_no_threats_from_threat() -> xml.etree.ElementTree.Element:
    """Get the XML element tree for no threat events in test_resources"""
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_no_events.XML')
    return xml_element


@pytest.fixture
def get_multi_threats_from_threat() -> xml.etree.ElementTree.Element:
    """Get the XML element tree for multi threat events in test_resources"""
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_mixed_results.XML')
    return xml_element


def test_print_threats_if_found(get_no_threats_from_threat, get_multi_threats_from_threat,
                                get_single_threats_from_threat):
    """
    This test function takes in pytest fixtures containing XML element trees,
    and uses the fixtures to test that the results from the class are correct.

    :param get_no_threats_from_threat: XML element tree containing data with no threats
    :param get_multi_threats_from_threat: XML element tree containing data with no multi threats
    :param get_single_threats_from_threat: XML element tree containing data with single threats
    :return: None
    """
    # Test that the no threat XML file returns a False bool
    no_threat_bool_result = Threats(get_no_threats_from_threat)
    assert no_threat_bool_result.print_threats_if_found() is False

    # Test that the single threat XML file returns a True bool
    single_threat_bool_result = Threats(get_single_threats_from_threat)
    assert single_threat_bool_result.print_threats_if_found() is True

    # Test that the multi threat XML file returns a True bool
    multi_threat_bool_result = Threats(get_multi_threats_from_threat)
    assert multi_threat_bool_result.print_threats_if_found() is True
