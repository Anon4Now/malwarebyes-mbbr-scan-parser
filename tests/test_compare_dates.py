"""Module containing tests for the compare_dates.py"""
import pytest

# Local App imports
from resources.compare_dates import DatabaseDate
from resources.utils import read_file


@pytest.fixture
def get_single_threats():
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_all_single_events.XML')
    return xml_element


@pytest.fixture
def get_no_threats():
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_no_events.XML')
    return xml_element


@pytest.fixture
def get_multi_threats():
    xml_element = read_file('tests/test_resources/MBBR-STDOUT_mixed_results.XML')
    return xml_element


def test_database_dates(get_no_threats, get_multi_threats, get_single_threats):
    no_threat_dates = DatabaseDate(get_no_threats)
    assert no_threat_dates.database_dates == {'malware-database': 252, 'rootkit-database': 252}

    single_threat_dates = DatabaseDate(get_single_threats)
    assert single_threat_dates.database_dates == {'malware-database': 2815, 'rootkit-database': 2815}

    multi_threat_dates = DatabaseDate(get_multi_threats)
    assert multi_threat_dates.database_dates == {'malware-database': 2815, 'rootkit-database': 2815}
